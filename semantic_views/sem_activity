name: SEM_ACTIVITY
description: "Activity and lifestyle analytics semantic model covering exercise sessions, meals, sleep patterns, blood pressure, and CGM data. Links behavioral factors to glucose outcomes for personalized wellness insights."

tables:
  - name: V_GOLD_ASSOCIATIONS
    description: "Statistical associations between candidate factors and health outcomes."
    base_table:
      database: DB_INSULINTEL
      schema: SCH_SEMANTIC
      table: V_GOLD_ASSOCIATIONS
    dimensions:
      - name: CANDIDATE_FACTOR
        expr: CANDIDATE_FACTOR
        data_type: VARCHAR
      - name: DATASET_SOURCE
        expr: DATASET_SOURCE
        data_type: VARCHAR
      - name: DIRECTION
        expr: DIRECTION
        data_type: VARCHAR
      - name: GUARDRAIL_NOTE
        expr: GUARDRAIL_NOTE
        data_type: VARCHAR
      - name: OUTCOME_TYPE
        expr: OUTCOME_TYPE
        data_type: VARCHAR
      - name: PARTICIPANT_ID
        expr: PARTICIPANT_ID
        data_type: VARCHAR
      - name: SUGGESTED_ACTION
        expr: SUGGESTED_ACTION
        data_type: VARCHAR
      - name: STRENGTH_GRADE
        expr: STRENGTH_GRADE
        data_type: VARCHAR
      - name: ASSOCIATION_DATE
        expr: ASSOCIATION_DATE
        data_type: DATE
    facts:
      - name: ASSOCIATION_STRENGTH
        expr: ASSOCIATION_STRENGTH
        data_type: FLOAT
      - name: CONFIDENCE
        expr: CONFIDENCE
        data_type: NUMBER
    metrics:
      - name: UNIQUE_PARTICIPANTS_COUNT
        description: "Count of unique participants"
        expr: "COUNT(DISTINCT PARTICIPANT_ID)"

  - name: V_GOLD_BP_DAILY_SUMMARY
    description: "Daily blood pressure summary statistics."
    base_table:
      database: DB_INSULINTEL
      schema: SCH_SEMANTIC
      table: V_GOLD_BP_DAILY_SUMMARY
    primary_key:
      columns:
        - DATASET_SOURCE
        - PARTICIPANT_ID
        - READING_DATE
    dimensions:
      - name: DATASET_SOURCE
        expr: DATASET_SOURCE
        data_type: VARCHAR
      - name: PARTICIPANT_ID
        expr: PARTICIPANT_ID
        data_type: VARCHAR
      - name: READING_DATE
        expr: READING_DATE
        data_type: DATE
      - name: USER_TIMEZONE_IANA
        expr: USER_TIMEZONE_IANA
        data_type: VARCHAR
    facts:
      - name: SYSTOLIC_MEAN
        expr: SYSTOLIC_MEAN
        data_type: FLOAT
      - name: SYSTOLIC_MIN
        expr: SYSTOLIC_MIN
        data_type: FLOAT
      - name: SYSTOLIC_MAX
        expr: SYSTOLIC_MAX
        data_type: FLOAT
      - name: SYSTOLIC_STD
        expr: SYSTOLIC_STD
        data_type: FLOAT
      - name: DIASTOLIC_MEAN
        expr: DIASTOLIC_MEAN
        data_type: FLOAT
      - name: DIASTOLIC_MIN
        expr: DIASTOLIC_MIN
        data_type: FLOAT
      - name: DIASTOLIC_MAX
        expr: DIASTOLIC_MAX
        data_type: FLOAT
      - name: DIASTOLIC_STD
        expr: DIASTOLIC_STD
        data_type: FLOAT
      - name: MAP_MEAN
        expr: MAP_MEAN
        data_type: FLOAT
      - name: PULSE_PRESSURE_MEAN
        expr: PULSE_PRESSURE_MEAN
        data_type: FLOAT
      - name: READING_COUNT
        expr: READING_COUNT
        data_type: NUMBER

  - name: V_GOLD_BP_READINGS
    description: "Individual blood pressure readings."
    base_table:
      database: DB_INSULINTEL
      schema: SCH_SEMANTIC
      table: V_GOLD_BP_READINGS
    dimensions:
      - name: DATASET_SOURCE
        expr: DATASET_SOURCE
        data_type: VARCHAR
      - name: PARTICIPANT_ID
        expr: PARTICIPANT_ID
        data_type: VARCHAR
      - name: MEASURED_DATE
        expr: MEASURED_DATE
        data_type: DATE
      - name: BP_CATEGORY
        expr: BP_CATEGORY
        data_type: VARCHAR
      - name: SOURCE_NAME
        expr: SOURCE_NAME
        data_type: VARCHAR
    facts:
      - name: SYSTOLIC_MMHG
        expr: SYSTOLIC_MMHG
        data_type: FLOAT
      - name: DIASTOLIC_MMHG
        expr: DIASTOLIC_MMHG
        data_type: FLOAT
      - name: MAP_MMHG
        expr: MAP_MMHG
        data_type: FLOAT
      - name: PULSE_PRESSURE_MMHG
        expr: PULSE_PRESSURE_MMHG
        data_type: FLOAT

  - name: V_GOLD_CGM_SUBJECTS
    description: "CGM participant summary."
    base_table:
      database: DB_INSULINTEL
      schema: SCH_SEMANTIC
      table: V_GOLD_CGM_SUBJECTS
    primary_key:
      columns:
        - DATASET_SOURCE
        - PARTICIPANT_ID
    dimensions:
      - name: DATASET_SOURCE
        expr: DATASET_SOURCE
        data_type: VARCHAR
      - name: PARTICIPANT_ID
        expr: PARTICIPANT_ID
        data_type: VARCHAR
    facts:
      - name: N_READINGS
        expr: N_READINGS
        data_type: NUMBER
      - name: N_DATA_SOURCES
        expr: N_DATA_SOURCES
        data_type: NUMBER
      - name: N_DEVICES
        expr: N_DEVICES
        data_type: NUMBER
      - name: N_DEVICE_TYPES
        expr: N_DEVICE_TYPES
        data_type: NUMBER

  - name: V_GOLD_EXERCISE_SESSIONS
    description: "Exercise session records."
    base_table:
      database: DB_INSULINTEL
      schema: SCH_SEMANTIC
      table: V_GOLD_EXERCISE_SESSIONS
    dimensions:
      - name: DATASET_SOURCE
        expr: DATASET_SOURCE
        data_type: VARCHAR
      - name: PARTICIPANT_ID
        expr: PARTICIPANT_ID
        data_type: VARCHAR
      - name: SESSION_ID
        expr: SESSION_ID
        data_type: VARCHAR
      - name: ACTIVITY_TYPE
        expr: ACTIVITY_TYPE
        data_type: VARCHAR
      - name: INTENSITY_BAND
        expr: INTENSITY_BAND
        data_type: VARCHAR
      - name: SESSION_TYPE
        expr: SESSION_TYPE
        data_type: VARCHAR
      - name: SESSION_DATE
        expr: SESSION_DATE
        data_type: DATE
      - name: GLUCOSE_RESPONSE_TYPE
        expr: GLUCOSE_RESPONSE_TYPE
        data_type: VARCHAR
    facts:
      - name: DURATION_MINUTES
        expr: DURATION_MINUTES
        data_type: NUMBER
      - name: EXERCISE_MINUTES
        expr: EXERCISE_MINUTES
        data_type: NUMBER
      - name: ACTIVE_ENERGY_KCAL
        expr: ACTIVE_ENERGY_KCAL
        data_type: FLOAT
      - name: AVG_METS
        expr: AVG_METS
        data_type: FLOAT
      - name: PRE_GLUCOSE_MEAN
        expr: PRE_GLUCOSE_MEAN
        data_type: FLOAT
      - name: POST_GLUCOSE_MEAN
        expr: POST_GLUCOSE_MEAN
        data_type: FLOAT
      - name: GLUCOSE_CHANGE_2H
        expr: GLUCOSE_CHANGE_2H
        data_type: FLOAT
      - name: CONFIDENCE
        expr: CONFIDENCE
        data_type: NUMBER

  - name: V_GOLD_MEAL_DAILY
    description: "Daily meal summaries."
    base_table:
      database: DB_INSULINTEL
      schema: SCH_SEMANTIC
      table: V_GOLD_MEAL_DAILY
    primary_key:
      columns:
        - DATASET_SOURCE
        - PARTICIPANT_ID
        - READING_DATE
    dimensions:
      - name: DATASET_SOURCE
        expr: DATASET_SOURCE
        data_type: VARCHAR
      - name: PARTICIPANT_ID
        expr: PARTICIPANT_ID
        data_type: VARCHAR
      - name: READING_DATE
        expr: READING_DATE
        data_type: DATE
    facts:
      - name: TOTAL_CARBS_G
        expr: TOTAL_CARBS_G
        data_type: FLOAT
      - name: TOTAL_PROTEIN_G
        expr: TOTAL_PROTEIN_G
        data_type: FLOAT
      - name: TOTAL_FAT_G
        expr: TOTAL_FAT_G
        data_type: FLOAT
      - name: MEAL_COUNT
        expr: MEAL_COUNT
        data_type: NUMBER
      - name: AVG_CARBS_G
        expr: AVG_CARBS_G
        data_type: FLOAT
      - name: AVG_MEAL_SCORE
        expr: AVG_MEAL_SCORE
        data_type: FLOAT

  - name: V_GOLD_MEAL_POSTMEAL
    description: "Post-meal glucose response."
    base_table:
      database: DB_INSULINTEL
      schema: SCH_SEMANTIC
      table: V_GOLD_MEAL_POSTMEAL
    dimensions:
      - name: DATASET_SOURCE
        expr: DATASET_SOURCE
        data_type: VARCHAR
      - name: PARTICIPANT_ID
        expr: PARTICIPANT_ID
        data_type: VARCHAR
      - name: SESSION_ID
        expr: SESSION_ID
        data_type: VARCHAR
      - name: MEAL_START_TS
        expr: MEAL_START_TS
        data_type: TIMESTAMP_NTZ
      - name: MEAL_END_TS
        expr: MEAL_END_TS
        data_type: TIMESTAMP_NTZ
    facts:
      - name: CARBS_G
        expr: CARBS_G
        data_type: FLOAT
      - name: POSTMEAL_AVG_0_120
        expr: POSTMEAL_AVG_0_120
        data_type: FLOAT
      - name: POSTMEAL_MAX_0_120
        expr: POSTMEAL_MAX_0_120
        data_type: FLOAT
      - name: POSTMEAL_MIN_0_120
        expr: POSTMEAL_MIN_0_120
        data_type: FLOAT

  - name: V_GOLD_MEAL_SESSIONS
    description: "Individual meal sessions."
    base_table:
      database: DB_INSULINTEL
      schema: SCH_SEMANTIC
      table: V_GOLD_MEAL_SESSIONS
    dimensions:
      - name: DATASET_SOURCE
        expr: DATASET_SOURCE
        data_type: VARCHAR
      - name: PARTICIPANT_ID
        expr: PARTICIPANT_ID
        data_type: VARCHAR
      - name: SESSION_ID
        expr: SESSION_ID
        data_type: VARCHAR
      - name: MEAL_TYPE_INFERRED
        expr: MEAL_TYPE_INFERRED
        data_type: VARCHAR
      - name: CARB_CATEGORY
        expr: CARB_CATEGORY
        data_type: VARCHAR
      - name: GLUCOSE_SPIKE_GRADE
        expr: GLUCOSE_SPIKE_GRADE
        data_type: VARCHAR
      - name: MEAL_DATE
        expr: MEAL_DATE
        data_type: DATE
    facts:
      - name: CARBS_G
        expr: CARBS_G
        data_type: FLOAT
      - name: PROTEIN_G
        expr: PROTEIN_G
        data_type: FLOAT
      - name: FAT_TOTAL_G
        expr: FAT_TOTAL_G
        data_type: FLOAT
      - name: MEAL_SCORE
        expr: MEAL_SCORE
        data_type: FLOAT
      - name: PEAK_GLUCOSE
        expr: PEAK_GLUCOSE
        data_type: FLOAT
      - name: PEAK_DELTA
        expr: PEAK_DELTA
        data_type: FLOAT

  - name: V_GOLD_SLEEP_DAILY
    description: "Daily sleep summaries."
    base_table:
      database: DB_INSULINTEL
      schema: SCH_SEMANTIC
      table: V_GOLD_SLEEP_DAILY
    primary_key:
      columns:
        - DATASET_SOURCE
        - PARTICIPANT_ID
        - SLEEP_DATE
    dimensions:
      - name: DATASET_SOURCE
        expr: DATASET_SOURCE
        data_type: VARCHAR
      - name: PARTICIPANT_ID
        expr: PARTICIPANT_ID
        data_type: VARCHAR
      - name: SLEEP_DATE
        expr: SLEEP_DATE
        data_type: DATE
      - name: SLEEP_DURATION_GRADE
        expr: SLEEP_DURATION_GRADE
        data_type: VARCHAR
      - name: REGULARITY_GRADE
        expr: REGULARITY_GRADE
        data_type: VARCHAR
    facts:
      - name: SLEEP_DURATION_MINUTES
        expr: SLEEP_DURATION_MINUTES
        data_type: NUMBER
      - name: SLEEP_DURATION_HOURS
        expr: SLEEP_DURATION_HOURS
        data_type: FLOAT
      - name: FRAGMENTATION_INDEX
        expr: FRAGMENTATION_INDEX
        data_type: FLOAT
      - name: SLEEP_CONFIDENCE
        expr: SLEEP_CONFIDENCE
        data_type: NUMBER

  - name: V_GOLD_SLEEP_GLUCOSE_DAILY
    description: "Daily sleep with glucose context."
    base_table:
      database: DB_INSULINTEL
      schema: SCH_SEMANTIC
      table: V_GOLD_SLEEP_GLUCOSE_DAILY
    dimensions:
      - name: DATASET_SOURCE
        expr: DATASET_SOURCE
        data_type: VARCHAR
      - name: PARTICIPANT_ID
        expr: PARTICIPANT_ID
        data_type: VARCHAR
      - name: READING_DATE
        expr: READING_DATE
        data_type: DATE
      - name: SLEEP_DURATION_GRADE
        expr: SLEEP_DURATION_GRADE
        data_type: VARCHAR
      - name: REGULARITY_GRADE
        expr: REGULARITY_GRADE
        data_type: VARCHAR
    facts:
      - name: GLUCOSE_MEAN
        expr: GLUCOSE_MEAN
        data_type: FLOAT
      - name: GLUCOSE_CV_PCT
        expr: GLUCOSE_CV_PCT
        data_type: FLOAT
      - name: TIR_IN_RANGE_PCT
        expr: TIR_IN_RANGE_PCT
        data_type: FLOAT
      - name: TIME_BELOW_RANGE_PCT
        expr: TIME_BELOW_RANGE_PCT
        data_type: FLOAT
      - name: TIME_ABOVE_RANGE_PCT
        expr: TIME_ABOVE_RANGE_PCT
        data_type: FLOAT
      - name: SLEEP_DURATION_HOURS
        expr: SLEEP_DURATION_HOURS
        data_type: FLOAT
      - name: DAWN_GLUCOSE_RISE
        expr: DAWN_GLUCOSE_RISE
        data_type: FLOAT

  - name: V_GOLD_SLEEP_SESSIONS
    description: "Individual sleep sessions."
    base_table:
      database: DB_INSULINTEL
      schema: SCH_SEMANTIC
      table: V_GOLD_SLEEP_SESSIONS
    dimensions:
      - name: DATASET_SOURCE
        expr: DATASET_SOURCE
        data_type: VARCHAR
      - name: PARTICIPANT_ID
        expr: PARTICIPANT_ID
        data_type: VARCHAR
      - name: SLEEP_SESSION_ID
        expr: SLEEP_SESSION_ID
        data_type: VARCHAR
      - name: SLEEP_DATE
        expr: SLEEP_DATE
        data_type: DATE
      - name: SLEEP_CONFIDENCE_LEVEL
        expr: SLEEP_CONFIDENCE_LEVEL
        data_type: VARCHAR
      - name: IS_PRIMARY_SLEEP
        expr: IS_PRIMARY_SLEEP
        data_type: BOOLEAN
      - name: IS_NAP
        expr: IS_NAP
        data_type: BOOLEAN
    facts:
      - name: SLEEP_DURATION_MINUTES
        expr: SLEEP_DURATION_MINUTES
        data_type: NUMBER
      - name: SLEEP_DURATION_HOURS
        expr: SLEEP_DURATION_HOURS
        data_type: FLOAT
      - name: TIME_IN_BED_MINUTES
        expr: TIME_IN_BED_MINUTES
        data_type: NUMBER
      - name: SESSION_FRAGMENTATION_INDEX
        expr: SESSION_FRAGMENTATION_INDEX
        data_type: FLOAT

  - name: V_GOLD_SLEEP_SESSIONS_PRIMARY
    description: "Primary sleep session per night."
    base_table:
      database: DB_INSULINTEL
      schema: SCH_SEMANTIC
      table: V_GOLD_SLEEP_SESSIONS_PRIMARY
    dimensions:
      - name: DATASET_SOURCE
        expr: DATASET_SOURCE
        data_type: VARCHAR
      - name: PARTICIPANT_ID
        expr: PARTICIPANT_ID
        data_type: VARCHAR
      - name: SLEEP_DATE
        expr: SLEEP_DATE
        data_type: DATE
      - name: SLEEP_SESSION_ID
        expr: SLEEP_SESSION_ID
        data_type: VARCHAR
      - name: SLEEP_CONFIDENCE_LEVEL
        expr: SLEEP_CONFIDENCE_LEVEL
        data_type: VARCHAR
    facts:
      - name: SLEEP_DURATION_MINUTES
        expr: SLEEP_DURATION_MINUTES
        data_type: NUMBER
      - name: SLEEP_DURATION_HOURS
        expr: SLEEP_DURATION_HOURS
        data_type: FLOAT
      - name: TIME_IN_BED_MINUTES
        expr: TIME_IN_BED_MINUTES
        data_type: NUMBER

relationships:
  - name: BP_READINGS_TO_DAILY
    leftTable: V_GOLD_BP_READINGS
    rightTable: V_GOLD_BP_DAILY_SUMMARY
    relationshipColumns:
      - leftColumn: DATASET_SOURCE
        rightColumn: DATASET_SOURCE
      - leftColumn: PARTICIPANT_ID
        rightColumn: PARTICIPANT_ID
      - leftColumn: MEASURED_DATE
        rightColumn: READING_DATE
    relationshipType: many_to_one

  - name: SLEEP_SESSIONS_TO_DAILY
    leftTable: V_GOLD_SLEEP_SESSIONS
    rightTable: V_GOLD_SLEEP_DAILY
    relationshipColumns:
      - leftColumn: DATASET_SOURCE
        rightColumn: DATASET_SOURCE
      - leftColumn: PARTICIPANT_ID
        rightColumn: PARTICIPANT_ID
      - leftColumn: SLEEP_DATE
        rightColumn: SLEEP_DATE
    relationshipType: many_to_one

  - name: MEAL_SESSIONS_TO_DAILY
    leftTable: V_GOLD_MEAL_SESSIONS
    rightTable: V_GOLD_MEAL_DAILY
    relationshipColumns:
      - leftColumn: DATASET_SOURCE
        rightColumn: DATASET_SOURCE
      - leftColumn: PARTICIPANT_ID
        rightColumn: PARTICIPANT_ID
      - leftColumn: MEAL_DATE
        rightColumn: READING_DATE
    relationshipType: many_to_one
